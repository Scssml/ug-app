(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21e97e22"],{"742e":function(t,e,i){},"963c":function(t,e,i){"use strict";var a=i("742e"),n=i.n(a);n.a},c67a:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-dialog",{attrs:{value:t.loadingDialog,persistent:"","max-width":"320px"}},[i("v-list",t._l(t.loadingData,function(e,a){return i("v-list-tile",{key:a,attrs:{avatar:"",color:e.error?"red":e.color}},[i("v-list-tile-avatar",[i("v-progress-circular",{attrs:{value:100,size:30,color:e.error?"red":e.color,indeterminate:e.loading}})],1),i("v-list-tile-content",[i("v-list-tile-title",[t._v(t._s(e.title))])],1)],1)}))],1),t.loadingDialog?t._e():[i("v-card",[i("v-card-title",[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{staticClass:"px-3",attrs:{xs4:""}},[i("v-text-field",{attrs:{"prepend-icon":"search",label:"Поиск","single-line":"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),i("v-flex",{staticClass:"px-3",attrs:{xs2:""}},[i("v-select",{attrs:{label:"Тип клиента",items:[{id:"",name:"Все"}].concat(t.typeClient),"item-text":"name","item-value":"id","hide-details":""},model:{value:t.filter.type,callback:function(e){t.$set(t.filter,"type",e)},expression:"filter.type"}})],1)],1),i("v-spacer"),i("v-dialog",{attrs:{persistent:"","max-width":"420px"},model:{value:t.dialogForm,callback:function(e){t.dialogForm=e},expression:"dialogForm"}},[i("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",dark:""},slot:"activator"},[t._v("Добавить")]),t.dialogForm?[t.editedId?i("client-edit",{attrs:{id:t.editedId},on:{cancel:function(e){t.closeDialog()}}}):i("client-add",{on:{cancel:function(e){t.closeDialog()}}})]:t._e()],2)],1),i("v-data-table",{attrs:{headers:t.headersTable,items:t.clientsList,"hide-actions":"","no-data-text":"Клиентов не найдено","no-results-text":"Клиентов не найдено",search:t.search,"custom-filter":t.customFilter},scopedSlots:t._u([{key:"items",fn:function(e){return[i("td",{staticClass:"text-xs-right",staticStyle:{width:"30px"}},[t._v(t._s(e.item.id))]),i("td",[t._v(t._s(e.item.name))]),i("td",[t._v(t._s(e.item.phone))]),i("td",[t._v("\n            "+t._s(e.item.typeName)+"\n          ")]),i("td",[t._v(t._s(e.item.birthDay))]),i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.bill))]),i("td",{staticClass:"text-xs-right"},[t._v(t._s(e.item.sale))]),i("td",{staticClass:"text-xs-right"},[t._v("\n            "+t._s(e.item.isActive?"Да":"Нет")+"\n          ")]),i("td",{staticClass:"text-xs-right",staticStyle:{width:"110px"}},[i("v-icon",{staticClass:"mr-2",on:{click:function(i){t.showOrders(e.item.id)}}},[t._v("\n              assignment\n            ")]),i("v-icon",{on:{click:function(i){t.editItem(e.item.id)}}},[t._v("\n              edit\n            ")])],1)]}}])})],1)]],2)},n=[],l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",[i("v-alert",{staticClass:"my-0",attrs:{value:t.createdSuccess,type:"success"}},[t._v("Клиент изменен")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4"},[i("span",{staticClass:"headline"},[t._v("Изменение клиента")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4"},[i("v-select",{staticClass:"mb-4",attrs:{label:"Тип клиента",items:t.typeClient,rules:[function(t){return!!t||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},model:{value:t.editedItem.type,callback:function(e){t.$set(t.editedItem,"type",e)},expression:"editedItem.type"}}),i("v-text-field",{attrs:{label:"Имя",rules:[function(t){return!!t||"Заполните поле"}]},model:{value:t.editedItem.name,callback:function(e){t.$set(t.editedItem,"name",e)},expression:"editedItem.name"}}),i("v-text-field",{attrs:{label:"Телефон"},model:{value:t.editedItem.phone,callback:function(e){t.$set(t.editedItem,"phone",e)},expression:"editedItem.phone"}}),i("v-menu",{staticClass:"mb-4",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:t.dataPicker,callback:function(e){t.dataPicker=e},expression:"dataPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"День рождения","prepend-icon":"event","hide-details":"",rules:[function(t){return!!t||"Заполните поле"}],readonly:""},slot:"activator",model:{value:t.editedItem.birthDay,callback:function(e){t.$set(t.editedItem,"birthDay",e)},expression:"editedItem.birthDay"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1"},on:{input:function(e){t.dataPicker=!1}},model:{value:t.editedItem.birthDay,callback:function(e){t.$set(t.editedItem,"birthDay",e)},expression:"editedItem.birthDay"}})],1),i("v-text-field",{attrs:{label:"Счет",type:"number"},model:{value:t.editedItem.bill,callback:function(e){t.$set(t.editedItem,"bill",t._n(e))},expression:"editedItem.bill"}}),i("v-text-field",{attrs:{label:"Лимит",type:"number"},model:{value:t.editedItem.credit,callback:function(e){t.$set(t.editedItem,"credit",t._n(e))},expression:"editedItem.credit"}}),i("v-text-field",{attrs:{label:"Скидка",type:"number"},model:{value:t.editedItem.sale,callback:function(e){t.$set(t.editedItem,"sale",t._n(e))},expression:"editedItem.sale"}}),i("v-checkbox",{attrs:{label:"Активность",color:"primary"},model:{value:t.editedItem.isActive,callback:function(e){t.$set(t.editedItem,"isActive",e)},expression:"editedItem.isActive"}})],1),i("v-card-actions",{staticClass:"px-4 pb-4"},[i("v-btn",{nativeOn:{click:function(e){t.cancel()}}},[t._v("Отмена")]),i("v-spacer"),i("v-btn",{attrs:{color:"info"},on:{click:t.submitForm}},[t._v("Сохранить")])],1)],1)],1)},s=[],c={props:{id:{type:Number,required:!0}},data:function(){return{dataPicker:!1,editedItem:{},typeClient:[],createdSuccess:!1}},methods:{getItem:function(){var t=this;if(this.id){var e={type:"clients",id:this.id};this.$store.dispatch("getItem",e).then(function(e){t.editedItem=e,t.editedItem.bill=+t.editedItem.bill,t.editedItem.sale=+t.editedItem.sale}).catch(function(){console.log("error")})}},cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},submitForm:function(){var t=this,e=this.$refs.form.validate();if(e){var i=Object.assign({},this.editedItem);delete i.id;var a={type:"clients",id:this.id,props:i};this.$store.dispatch("updateItem",a).then(function(){t.createdSuccess=!0,setTimeout(function(){t.$emit("cancel")},1e3)})}},getClientTypeList:function(){var t=this,e={type:"client-type"};this.$store.dispatch("getItemsList",e).then(function(e){t.typeClient=e.map(function(t){return t.id=+t.id,t})}).catch(function(){console.log("error")})}},mounted:function(){this.getItem(),this.getClientTypeList()}},r=c,d=i("2877"),o=Object(d["a"])(r,l,s,!1,null,null,null),u=o.exports,m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-card",[i("v-alert",{staticClass:"my-0",attrs:{value:t.createdSuccess,type:"success"}},[t._v("Клиент добавлен")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4"},[i("span",{staticClass:"headline"},[t._v("Добавление клиента")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4"},[i("v-select",{staticClass:"mb-4",attrs:{label:"Тип клиента",items:t.typeClient,rules:[function(t){return!!t||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},model:{value:t.editedItem.type,callback:function(e){t.$set(t.editedItem,"type",e)},expression:"editedItem.type"}}),i("v-text-field",{attrs:{label:"Имя",rules:[function(t){return!!t||"Заполните поле"}]},model:{value:t.editedItem.name,callback:function(e){t.$set(t.editedItem,"name",e)},expression:"editedItem.name"}}),i("v-text-field",{attrs:{label:"Телефон"},model:{value:t.editedItem.phone,callback:function(e){t.$set(t.editedItem,"phone",e)},expression:"editedItem.phone"}}),i("v-menu",{staticClass:"mb-4",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:t.dataPicker,callback:function(e){t.dataPicker=e},expression:"dataPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"День рождения","prepend-icon":"event","hide-details":"",rules:[function(t){return!!t||"Заполните поле"}],readonly:""},slot:"activator",model:{value:t.editedItem.birthDay,callback:function(e){t.$set(t.editedItem,"birthDay",e)},expression:"editedItem.birthDay"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1"},on:{input:function(e){t.dataPicker=!1}},model:{value:t.editedItem.birthDay,callback:function(e){t.$set(t.editedItem,"birthDay",e)},expression:"editedItem.birthDay"}})],1),i("v-text-field",{attrs:{label:"Счет",type:"number"},model:{value:t.editedItem.bill,callback:function(e){t.$set(t.editedItem,"bill",t._n(e))},expression:"editedItem.bill"}}),i("v-text-field",{attrs:{label:"Лимит",type:"number"},model:{value:t.editedItem.credit,callback:function(e){t.$set(t.editedItem,"credit",t._n(e))},expression:"editedItem.credit"}}),i("v-text-field",{attrs:{label:"Скидка",type:"number"},model:{value:t.editedItem.sale,callback:function(e){t.$set(t.editedItem,"sale",t._n(e))},expression:"editedItem.sale"}}),i("v-checkbox",{attrs:{label:"Активность",color:"primary"},model:{value:t.editedItem.isActive,callback:function(e){t.$set(t.editedItem,"isActive",e)},expression:"editedItem.isActive"}})],1),i("v-card-actions",{staticClass:"px-4 pb-4"},[i("v-btn",{nativeOn:{click:function(e){t.cancel()}}},[t._v("Отмена")]),i("v-spacer"),i("v-btn",{attrs:{color:"info"},on:{click:t.submitForm}},[t._v("Сохранить")])],1)],1)],1)},v=[],p={data:function(){return{dataPicker:!1,editedItem:{name:"",birthDay:"",bill:0,sale:0,phone:"",isActive:!0,type:0},typeClient:[],createdSuccess:!1}},methods:{cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},submitForm:function(){var t=this,e=this.$refs.form.validate();if(e){var i=Object.assign({},this.editedItem);delete i.id;var a={type:"clients",props:i};this.$store.dispatch("addItem",a).then(function(){t.createdSuccess=!0,setTimeout(function(){t.$emit("cancel")},1e3)})}},getClientTypeList:function(){var t=this,e={type:"client-type"};this.$store.dispatch("getItemsList",e).then(function(e){t.typeClient=e.map(function(t){return t.id=+t.id,t})}).catch(function(){console.log("error")})}},mounted:function(){this.getClientTypeList()}},f=p,h=Object(d["a"])(f,m,v,!1,null,null,null),b=h.exports,y={name:"Clients",components:{ClientEdit:u,ClientAdd:b},data:function(){return{loadingData:[{title:"Получение клиентов",error:!1,loading:!0,color:"indigo",id:"clients"}],filter:{type:""},typeClient:[],search:"",headersTable:[{text:"ID",align:"right",value:"id"},{text:"Клиент",align:"left",value:"name"},{text:"Телефон",align:"left",value:"phone"},{text:"Тип",align:"left",value:"type"},{text:"День рождения",align:"left",value:"birthDay"},{text:"Счет",align:"right",value:"bill"},{text:"Скидка",align:"right",value:"sale"},{text:"Активность",align:"right",value:"isActive"},{text:"",align:"right",sortable:!1,value:"action"}],dialogForm:!1,editedId:0,clientsList:[]}},computed:{loadingDialog:function(){var t=this.loadingData.filter(function(t){return!t.error&&!t.loading});return t.length===this.loadingData.length?0:1}},methods:{customFilter:function(t){var e=this.filter,i=[];return i=t.filter(function(t){var i=!1;return t.type!==e.type&&""!==e.type||(i=!0),i}),i},getClientsList:function(){var t=this,e={type:"clients"},i="Клиенты получены!",a="Ошибка получения клиентов!";this.$store.dispatch("getItemsList",e).then(function(a){t.clientsList=a.map(function(e){var i=t.typeClient.find(function(t){return t.id===e.type});return e.typeName=i?i.name:"-",e});var n=t.loadingData.find(function(t){return t.id===e.type});n.title=i,n.loading=!1}).catch(function(){var i=t.loadingData.find(function(t){return t.id===e.type});i.title=a,i.error=!0})},getClientTypeList:function(){var t=this,e={type:"client-type"};this.$store.dispatch("getItemsList",e).then(function(e){t.typeClient=e.map(function(t){return t.id=+t.id,t}),t.getClientsList()}).catch(function(){console.log("error")})},closeDialog:function(){this.getClientsList(),this.dialogForm=!1,this.editedId=0},editItem:function(t){this.editedId=+t,this.dialogForm=!0},showOrders:function(t){this.$router.push({path:"/orders/?client=".concat(t)})}},mounted:function(){this.getClientTypeList()}},x=y,I=(i("963c"),Object(d["a"])(x,a,n,!1,null,"307e5308",null));e["default"]=I.exports}}]);
//# sourceMappingURL=chunk-21e97e22.9b84734f.js.map