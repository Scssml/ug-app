(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5776d5c8"],{2748:function(e,t,i){"use strict";var r=i("7436"),a=i.n(r);a.a},2962:function(e,t,i){"use strict";var r=i("fa73"),a=i.n(r);a.a},"30e1":function(e,t,i){},4151:function(e,t,i){"use strict";var r=i("8509"),a=i.n(r);a.a},"442c":function(e,t,i){"use strict";var r=i("30e1"),a=i.n(r);a.a},7436:function(e,t,i){},"7f00":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[i("v-dialog",{attrs:{value:e.loadingDialog,persistent:"","max-width":"320px"}},[i("v-list",e._l(e.loadingData,function(t,r){return i("v-list-tile",{key:r,attrs:{avatar:"",color:t.error?"red":t.color}},[i("v-list-tile-avatar",[i("v-progress-circular",{attrs:{value:100,size:30,color:t.error?"red":t.color,indeterminate:t.loading}})],1),i("v-list-tile-content",[i("v-list-tile-title",[e._v(e._s(t.title))])],1)],1)}))],1),e.loadingDialog?e._e():[e.selectedOrders.length>0?i("v-snackbar",{attrs:{value:!0,color:"info",bottom:"",timeout:36e5}},[i("v-btn",{staticClass:"ml-0",attrs:{dark:"",flat:"",depressed:"",to:"/print/orders/delivery/"+e.printOrdersIds+"/",target:"_blank"}},[e._v("Печать бланков на доставку")]),i("v-btn",{attrs:{dark:"",flat:"",depressed:"",to:"/print/orders/florist/"+e.printOrdersIds+"/",target:"_blank"}},[e._v("Печать бланков флористов")])],1):e._e(),i("v-card",[i("v-card-title",[i("v-dialog",{attrs:{"max-width":e.editStatus||e.editDescription?"420px":"1200px",fullscreen:!e.editStatus&&!e.editDescription},model:{value:e.dialogForm,callback:function(t){e.dialogForm=t},expression:"dialogForm"}},[i("v-btn",{staticClass:"mb-2",attrs:{slot:"activator",color:"primary",dark:""},slot:"activator"},[e._v("Добавить")]),e.dialogForm?[e.editStatus?i("change-status",{attrs:{id:e.editedId,orderSourceType:e.orderSourceTypeEditElem},on:{cancel:function(t){e.closeDialog()}}}):e._e(),e.editDescription?i("change-description",{attrs:{id:e.editedId,orderSourceType:e.orderSourceTypeEditElem},on:{cancel:function(t){e.closeDialog()}}}):e._e(),!e.editedId||e.editStatus||e.editDescription?e._e():i("order-edit",{attrs:{id:e.editedId,copy:e.copyElem,orderSourceType:e.orderSourceTypeEditElem},on:{cancel:function(t){e.closeDialog()}}}),e.editedId||e.editStatus||e.editDescription||e.editSettings?e._e():i("order-add",{on:{cancel:function(t){e.closeDialog()}}}),e.editSettings?i("user-settings",{attrs:{userSettings:e.userSettings},on:{cancel:function(t){e.closeDialog()}}}):e._e()]:e._e()],2),i("v-spacer"),i("v-layout",{attrs:{row:"",wrap:"","justify-space-around":""}},[i("v-flex",{staticClass:"px-2",attrs:{xs2:""}},[i("v-select",{attrs:{label:"Статус",items:[{id:"",name:"Все"}].concat(e.statusList),"item-text":"name","item-value":"id","hide-details":""},on:{change:function(t){e.customFilter()}},model:{value:e.filter.orderStatus,callback:function(t){e.$set(e.filter,"orderStatus",t)},expression:"filter.orderStatus"}})],1),i("v-flex",{staticClass:"px-2",attrs:{xs2:""}},[i("v-autocomplete",{staticClass:"mb-4",attrs:{label:"Клиент",items:[{id:"",name:"Все",phone:""}].concat(e.clientsList),filter:e.clientsFilter,"item-text":"name","item-value":"id","hide-details":"","no-data-text":"Не надено"},on:{change:function(t){e.customFilter()}},model:{value:e.filter.client,callback:function(t){e.$set(e.filter,"client",t)},expression:"filter.client"}})],1),i("v-flex",{staticClass:"px-2",attrs:{xs2:""}},[i("v-select",{attrs:{label:"Время суток",items:[{id:"",name:"Все"}].concat(e.deliveryTimeOfDayFilter),"item-text":"name","item-value":"id","hide-details":""},on:{change:function(t){e.customFilter()}},model:{value:e.filter.deliveryTimeOfDay,callback:function(t){e.$set(e.filter,"deliveryTimeOfDay",t)},expression:"filter.deliveryTimeOfDay"}})],1),i("v-flex",{staticClass:"pl-2",attrs:{xs2:""}},[i("v-menu",{staticClass:"mb-4",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:e.dataStartPicker,callback:function(t){e.dataStartPicker=t},expression:"dataStartPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"Дата доставки (с)","prepend-icon":"event","hide-details":"",readonly:""},slot:"activator",model:{value:e.filter.dateStart,callback:function(t){e.$set(e.filter,"dateStart",t)},expression:"filter.dateStart"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1",max:e.filter.dateEnd?e.filter.dateEnd:void 0},on:{input:function(t){e.dataStartPicker=!1},change:function(t){e.customFilter()}},model:{value:e.filter.dateStart,callback:function(t){e.$set(e.filter,"dateStart",t)},expression:"filter.dateStart"}})],1)],1),i("v-flex",{staticClass:"pl-2",attrs:{xs2:""}},[i("v-menu",{staticClass:"mb-4",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:e.dataEndPicker,callback:function(t){e.dataEndPicker=t},expression:"dataEndPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"Дата доставки (по)","prepend-icon":"event","hide-details":"",readonly:""},slot:"activator",model:{value:e.filter.dateEnd,callback:function(t){e.$set(e.filter,"dateEnd",t)},expression:"filter.dateEnd"}}),i("v-date-picker",{attrs:{"no-title":"",locale:"ru-ru",scrollable:"","first-day-of-week":"1",min:e.filter.dateStart?e.filter.dateStart:void 0},on:{input:function(t){e.dataEndPicker=!1},change:function(t){e.customFilter()}},model:{value:e.filter.dateEnd,callback:function(t){e.$set(e.filter,"dateEnd",t)},expression:"filter.dateEnd"}})],1)],1)],1),i("v-spacer"),i("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:"",to:"/print/order/day-orders/"+e.dateNowStr+"/",target:"_blank"}},[e._v("Заказы за день")])],1),i("v-layout",{attrs:{row:"",wrap:"","align-center":""}},[i("v-flex",{staticClass:"px-1",attrs:{xs3:""}},[e._v("\n          Доставок на сегодня: "+e._s(e.deliveryNow)+"\n\n          "),i("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){t.preventDefault(),e.changeSettings()}}},[e._v("Настройки")])],1),i("v-flex",{staticClass:"px-1 text-xs-right",attrs:{xs9:""}},[i("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){t.preventDefault(),e.setFilterDateNow()}}},[e._v("За сегодня")]),i("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){t.preventDefault(),e.setFilterDateWeek()}}},[e._v("За неделю")]),i("v-btn",{attrs:{color:"primary",dark:""},on:{click:function(t){t.preventDefault(),e.setFilterDateMonth()}}},[e._v("За месяц")])],1)],1),i("v-data-table",{staticClass:"orders-table",attrs:{headers:e.headersTable,items:e.ordersList,"hide-actions":"","no-data-text":"Заказов не найдено","no-results-text":"Заказов не найдено",pagination:e.pagination,"select-all":"","item-key":"id"},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"headers",fn:function(t){return[i("tr",[i("th",{staticClass:"px-1 text-xs-left"},[i("v-checkbox",{attrs:{"input-value":t.all,indeterminate:t.indeterminate,color:"primary","hide-details":""},on:{click:function(t){return t.stopPropagation(),e.toggleAll(t)}}})],1),e._l(t.headers,function(t){return i("th",{key:t.text,staticClass:"px-1 text-xs-left",class:["column sortable",e.pagination.descending?"desc":"asc",t.value===e.pagination.sortBy?"active":""],style:{width:t.width+"px",maxWidth:t.width+"px",minWidth:t.width+"px"},on:{click:function(i){e.changeSort(t.value)}}},[i("v-icon",{attrs:{small:""}},[e._v("arrow_upward")]),e._v("\n              "+e._s(t.text)+"\n            ")],1)})],2)]}},{key:"items",fn:function(t){return[i("tr",{class:[t.item.orderStatus.color,t.item.topLine?"top-line":""]},[i("td",{staticClass:"px-1",staticStyle:{width:"30px","max-width":"30px","min-width":"30px"}},[i("v-checkbox",{attrs:{color:"primary","hide-details":""},model:{value:t.selected,callback:function(i){e.$set(t,"selected",i)},expression:"props.selected"}})],1),e._l(e.colsTable,function(r,a){return[i("td",{key:"col-"+a,staticClass:"px-1",style:{width:r.width+"px",maxWidth:r.width+"px",minWidth:r.width+"px"}},[e._l(r.dataFields,function(r,s){return[i("div",{key:"prop-"+a+"-"+s},[r.displayName?[e._v("\n                      "+e._s(r.displayName)+":\n                    ")]:e._e(),t.item[r.field]||"incognito"===r.field||"description"===r.field?["deliveryTimeOfDay"===r.field?[e._v("\n                        "+e._s(e.deliveryTimeOfDayList[t.item[r.field]])+"\n                      ")]:"createdBy"===r.field?[e._v("\n                        "+e._s(t.item[r.field].name)+"\n                      ")]:"orderSourceType"===r.field?[e._l(t.item[r.field],function(t,r){return[t?[r?i("br",{key:r}):e._e(),e._v(e._s(t.name)+"\n                          ")]:e._e()]})]:"incognito"===r.field?[e._v("\n                        "+e._s(t.item[r.field]?"Да":"Нет")+"\n                      ")]:"description"===r.field?[i("div",{style:t.item[r.field]?"":"min-height: 20px; box-shadow: 0 0 0 1px rgba(0,0,0,.12);",on:{click:function(i){e.changeDescription(t.item.id)}}},[e._v("\n                          "+e._s(t.item[r.field])+"\n                        ")])]:"bouquets"===r.field?[e._l(t.item[r.field],function(t,r){return[e._v("\n                          "+e._s(t.name)+" - "+e._s(t.count)+"\n                          "),i("br",{key:r})]})]:"orderStatus"===r.field?[i("div",{staticStyle:{display:"inline"},on:{click:function(i){e.changeStatus(t.item.id)}}},[e._v("\n                          "+e._s(t.item[r.field].name)+"\n                        ")])]:"deliveryType"===r.field?[e._v("\n                        "+e._s(t.item[r.field].name)+"\n                      ")]:"deliveryDate"===r.field?[e._v("\n                        "+e._s(t.item[r.field+"Str"])+"\n                      ")]:"courier"===r.field?[e._v("\n                        "+e._s(t.item[r.field].name)+"\n                      ")]:"clientType"===r.field?[e._v("\n                        "+e._s(t.item[r.field].name)+"\n                      ")]:[e._v("\n                        "+e._s(t.item[r.field])+"\n                      ")]]:e._e()],2)]})],2)]}),i("td",{staticClass:"text-xs-right px-1",staticStyle:{width:"100px","max-width":"100px","min-width":"100px"}},[1===t.item.orderStatus.id||7===t.item.orderStatus.id?i("v-icon",{attrs:{left:"",title:"Собрать"},on:{click:function(i){e.createdBouquet(t.item)}}},[e._v("\n                playlist_add\n              ")]):e._e(),i("v-icon",{attrs:{left:"",title:"Скопировать"},on:{click:function(i){e.editItem(t.item.id,!0)}}},[e._v("\n                add_to_photos\n              ")]),i("br"),i("v-icon",{attrs:{left:"",title:"Изменить"},on:{click:function(i){e.editItem(t.item.id)}}},[e._v("\n                edit\n              ")]),i("v-menu",{staticStyle:{"vertical-align":"top"}},[i("v-icon",{attrs:{slot:"activator",left:"",title:"Печать",color:t.item.isAlreadyPrinted?"teal darken-3":""},slot:"activator"},[e._v("\n                  insert_drive_file\n                ")]),i("v-list",[2===t.item.deliveryType.id?i("v-list-tile",{attrs:{to:"/print/order/delivery/"+t.item.id+"/",target:"_blank"}},[i("v-list-tile-title",[e._v("Печать бланка заказа на доставку")])],1):e._e(),i("v-list-tile",{attrs:{to:"/print/order/florist/"+t.item.id+"/",target:"_blank"}},[i("v-list-tile-title",[e._v("Печать бланка флориста")])],1)],1)],1)],1)],2)]}}]),model:{value:e.selectedOrders,callback:function(t){e.selectedOrders=t},expression:"selectedOrders"}})],1),i("v-btn",{staticClass:"mx-4",attrs:{fab:"",color:"info"},on:{click:function(t){e.dialogForm=!0}}},[i("v-icon",{attrs:{dark:""}},[e._v("add")])],1)]],2)},a=[],s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticClass:"order"},[i("v-alert",{staticClass:"my-0",attrs:{value:e.createdSuccess,type:"success"}},[e._v("Заказ изменен")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4 py-2"},[i("span",{staticClass:"headline"},[e._v("Изменение заказа")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4 pt-1"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{staticStyle:{"padding-right":"15px"},attrs:{xs7:2===e.editedItem.deliveryType}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:2===e.editedItem.deliveryType}},[i("v-select",{attrs:{label:"КТО",items:[e.userInfo],rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:""},model:{value:e.editedItem.createdBy,callback:function(t){e.$set(e.editedItem,"createdBy",e._n(t))},expression:"editedItem.createdBy"}}),i("v-select",{staticClass:"mb-4",attrs:{label:"Т/С",items:e.tsList,rules:[function(e){return e.length>0||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:e.editedItemReadOnly,chips:"",multiple:""},model:{value:e.editedItem.orderSourceType,callback:function(t){e.$set(e.editedItem,"orderSourceType",t)},expression:"editedItem.orderSourceType"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Д/П","hide-details":"",readonly:""},model:{value:e.editedItem.createdAt,callback:function(t){e.$set(e.editedItem,"createdAt",t)},expression:"editedItem.createdAt"}}),i("v-select",{staticClass:"mb-4",attrs:{label:"Способ доставки",items:e.deliveryList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:e.editedItemReadOnly},on:{change:function(t){e.editedItem.delivery=2===t}},model:{value:e.editedItem.deliveryType,callback:function(t){e.$set(e.editedItem,"deliveryType",e._n(t))},expression:"editedItem.deliveryType"}}),2!==e.editedItem.deliveryType?i("v-menu",{staticClass:"mb-2",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:e.dataPicker,callback:function(t){e.dataPicker=t},expression:"dataPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"Дата доставки",rules:[function(e){return!!e||"Заполните поле"}],"prepend-icon":"event","hide-details":"",readonly:""},slot:"activator",model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1",readonly:e.editedItemReadOnly},on:{input:function(t){e.dataPicker=!1}},model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}})],1):e._e(),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs7:""}},[2!==e.editedItem.deliveryType?i("v-text-field",{staticClass:"mb-4",attrs:{label:"Время доставки",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.deliveryTime,callback:function(t){e.$set(e.editedItem,"deliveryTime",t)},expression:"editedItem.deliveryTime"}}):e._e()],1),i("v-flex",{attrs:{xs5:""}},[2!==e.editedItem.deliveryType?i("v-select",{staticClass:"mb-4",attrs:{label:"Время суток",items:e.deliveryTimeOfDayList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.deliveryTimeOfDay,callback:function(t){e.$set(e.editedItem,"deliveryTimeOfDay",e._n(t))},expression:"editedItem.deliveryTimeOfDay"}}):e._e()],1)],1),i("v-select",{staticClass:"mb-4",attrs:{label:"Статус",items:e.statusList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.orderStatus,callback:function(t){e.$set(e.editedItem,"orderStatus",e._n(t))},expression:"editedItem.orderStatus"}}),i("v-autocomplete",{staticClass:"mb-4",attrs:{label:"Клиент",items:e.clientsList,filter:e.clientsFilter,"item-text":"name","item-value":"id","hide-details":"","no-data-text":"Не надено",readonly:e.editedItemReadOnly,clearable:""},on:{change:function(t){e.setDataClient()}},model:{value:e.editedItem.client,callback:function(t){e.$set(e.editedItem,"client",e._n(t))},expression:"editedItem.client"}}),i("v-select",{staticClass:"mb-4",attrs:{label:"Тип клиента",items:e.typeClient,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.clientType,callback:function(t){e.$set(e.editedItem,"clientType",e._n(t))},expression:"editedItem.clientType"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Имя",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.clientName,callback:function(t){e.$set(e.editedItem,"clientName",t)},expression:"editedItem.clientName"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Телефон",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.clientPhone,callback:function(t){e.$set(e.editedItem,"clientPhone",t)},expression:"editedItem.clientPhone"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Сумма","hide-details":"",readonly:e.editedItemReadOnly,type:"text"},model:{value:e.editedItem.orderCost,callback:function(t){e.$set(e.editedItem,"orderCost",t)},expression:"editedItem.orderCost"}})],1),2===e.editedItem.deliveryType?i("v-flex",{staticStyle:{"padding-left":"15px"},attrs:{xs6:""}},[3===e.editedItem.orderStatus||6===e.editedItem.orderStatus?i("v-select",{staticClass:"mb-4",attrs:{label:"Курьер",items:e.couriersList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","no-data-text":"Не надено","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.courier,callback:function(t){e.$set(e.editedItem,"courier",e._n(t))},expression:"editedItem.courier"}}):e._e(),i("v-menu",{staticClass:"mb-2",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:e.dataPicker,callback:function(t){e.dataPicker=t},expression:"dataPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"Дата доставки",rules:[function(e){return!!e||"Заполните поле"}],"prepend-icon":"event","hide-details":"",readonly:""},slot:"activator",model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1",readonly:e.editedItemReadOnly},on:{input:function(t){e.dataPicker=!1},change:function(t){e.getOrdersList()}},model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}})],1),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs7:""}},[i("v-text-field",{staticClass:"mb-4",attrs:{label:"Время доставки",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.deliveryTime,callback:function(t){e.$set(e.editedItem,"deliveryTime",t)},expression:"editedItem.deliveryTime"}})],1),i("v-flex",{attrs:{xs5:""}},[i("v-select",{staticClass:"mb-4",attrs:{label:"Время суток",items:e.deliveryTimeOfDayList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:e.editedItemReadOnly},on:{change:function(t){e.getOrdersList()}},model:{value:e.editedItem.deliveryTimeOfDay,callback:function(t){e.$set(e.editedItem,"deliveryTimeOfDay",e._n(t))},expression:"editedItem.deliveryTimeOfDay"}})],1)],1),i("v-checkbox",{staticClass:"mb-4",attrs:{label:"Инкогнито",color:"primary","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.incognito,callback:function(t){e.$set(e.editedItem,"incognito",t)},expression:"editedItem.incognito"}}),i("v-checkbox",{staticClass:"mb-4",attrs:{label:"Заказчик-получатель",color:"primary","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.clientAddressee,callback:function(t){e.clientAddressee=t},expression:"clientAddressee"}}),e.clientAddressee?e._e():i("v-autocomplete",{staticClass:"mb-4",attrs:{label:"Получатель",items:e.clientsList,filter:e.clientsFilter,"item-text":"name","item-value":"id","hide-details":"","no-data-text":"Не надено",readonly:e.editedItemReadOnly,clearable:""},on:{change:function(t){e.setDataAddressee()}},model:{value:e.editedItem.addressee,callback:function(t){e.$set(e.editedItem,"addressee",e._n(t))},expression:"editedItem.addressee"}}),e.clientAddressee?e._e():i("v-text-field",{staticClass:"mb-4",attrs:{label:"Имя получателя","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.addresseeName,callback:function(t){e.$set(e.editedItem,"addresseeName",t)},expression:"editedItem.addresseeName"}}),e.clientAddressee?e._e():i("v-text-field",{staticClass:"mb-4",attrs:{label:"Телефон получателя","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.addresseePhone,callback:function(t){e.$set(e.editedItem,"addresseePhone",t)},expression:"editedItem.addresseePhone"}}),i("autocomplete-address",{attrs:{value:e.editedItem.address,readonly:e.editedItemReadOnly},on:{change:function(t){e.updateAddress(t)}}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Квартира","hide-details":"",rules:[function(e){return!!e||"Заполните поле"}],readonly:e.editedItemReadOnly},model:{value:e.editedItem.flat,callback:function(t){e.$set(e.editedItem,"flat",t)},expression:"editedItem.flat"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Подъезд","hide-details":"",rules:[function(e){return!!e||"Заполните поле"}],readonly:e.editedItemReadOnly},model:{value:e.editedItem.entrance,callback:function(t){e.$set(e.editedItem,"entrance",t)},expression:"editedItem.entrance"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Этаж","hide-details":"",rules:[function(e){return!!e||"Заполните поле"}],readonly:e.editedItemReadOnly},model:{value:e.editedItem.floor,callback:function(t){e.$set(e.editedItem,"floor",t)},expression:"editedItem.floor"}})],1):e._e()],1),i("p",{staticClass:"mb-0"},[e._v("Букеты")]),e._l(e.editedItem.bouquets,function(t,r){return i("v-layout",{key:"bouquet-"+r,attrs:{row:"",wrap:"","align-center":""}},[i("v-flex",{staticClass:"pr-3",attrs:{xs9:""}},[i("v-textarea",{staticClass:"mb-4",attrs:{label:"Название",rules:[function(e){return!!e||"Заполните поле"}],"auto-grow":"","row-height":"6","hide-details":"",readonly:e.editedItemReadOnly},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"bouquet.name"}})],1),i("v-flex",{staticClass:"pr-3",attrs:{xs2:""}},[i("v-text-field",{staticClass:"mb-4",attrs:{label:"Кол-во",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":"",readonly:e.editedItemReadOnly},model:{value:t.count,callback:function(i){e.$set(t,"count",i)},expression:"bouquet.count"}})],1),i("v-flex",{attrs:{xs1:""}},[i("v-icon",{on:{click:function(t){e.bouquetDelete(r)}}},[e._v("\n                delete\n              ")])],1)],1)}),i("v-icon",{on:{click:function(t){e.bouquetAdd()}}},[e._v("\n            add\n          ")]),i("v-textarea",{staticClass:"my-4",attrs:{label:"Комментарий","auto-grow":"","row-height":"12","hide-details":"",readonly:e.editedItemReadOnly},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],2),2!==e.editedItem.deliveryType||e.loadOrder?e._e():i("v-flex",{attrs:{xs5:""}},[i("div",{staticStyle:{position:"relative",height:"100%",overflow:"hidden"}},[i("yandex-map",{staticStyle:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},attrs:{coords:[53.05,50.101783],zoom:"10",controls:["trafficControl"],placemarks:e.placemarks}})],1)]),i("v-flex",{attrs:{xs12:"","my-4":""}},[i("v-btn",{nativeOn:{click:function(t){e.showHistory=!e.showHistory}}},[e._v("Показать историю")]),e.showHistory?[i("v-data-table",{attrs:{headers:e.headersTableHistory,items:e.history,"hide-actions":"","item-key":"updated_at",pagination:e.pagination,"no-data-text":"Изменений не найдено","no-results-text":"Изменений не найдено"},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"items",fn:function(t){return[i("tr",{on:{click:function(e){t.expanded=!t.expanded}}},[i("td",[e._v(e._s(t.item.updated_atStr))]),i("td",[t.item.updatedBy?[e._v("\n                      "+e._s(t.item.updatedBy.name)+"\n                    ")]:e._e()],2)])]}},{key:"expand",fn:function(t){return[i("v-card",{attrs:{flat:""}},[i("v-card-text",[i("b",[e._v("Активность:")]),e._v(" "+e._s(t.item.active?"Да":"Нет")+"\n                    "),i("br"),i("b",[e._v("Адрес:")]),e._v(" "+e._s(t.item.address)+"\n                    "),i("br"),i("b",[e._v("Получатель:")]),e._v(" "+e._s(t.item.addresseeId)+"\n                    "),i("br"),i("b",[e._v("Имя получателя:")]),e._v(" "+e._s(t.item.addresseeName)+"\n                    "),i("br"),i("b",[e._v("Телефон получателя:")]),e._v(" "+e._s(t.item.addresseePhone)+"\n                    "),i("br"),i("b",[e._v("Клиент:")]),e._v(" "+e._s(t.item.clientId)+"\n                    "),i("br"),i("b",[e._v("Имя клиента:")]),e._v(" "+e._s(t.item.clientName)+"\n                    "),i("br"),i("b",[e._v("Телефон клиента:")]),e._v(" "+e._s(t.item.clientPhone)+"\n                    "),i("br"),i("b",[e._v("Тип клиента:")]),e._v(" "+e._s(t.item.clientTypeStr)+"\n                    "),i("br"),i("b",[e._v("Координаты:")]),e._v(" "+e._s(t.item.coordinates)+"\n                    "),i("br"),i("b",[e._v("Курьер:")]),e._v(" "+e._s(t.item.courierStr)+"\n                    "),i("br"),i("b",[e._v("Кто создал:")]),e._v(" "+e._s(t.item.createdById)+"\n                    "),i("br"),i("b",[e._v("Дата создания:")]),e._v(" "+e._s(t.item.created_atStr)+"\n                    "),i("br"),i("b",[e._v("Доставка:")]),e._v(" "+e._s(t.item.delivery?"Да":"Нет")+"\n                    "),i("br"),i("b",[e._v("Дата доставки:")]),e._v(" "+e._s(t.item.deliveryDateStr)+"\n                    "),i("br"),i("b",[e._v("Время доставки:")]),e._v(" "+e._s(t.item.deliveryTime)+"\n                    "),i("br"),i("b",[e._v("Тип доставки:")]),e._v(" "+e._s(t.item.deliveryTypeStr)+"\n                    "),i("br"),i("b",[e._v("Комментарий:")]),e._v(" "+e._s(t.item.description)+"\n                    "),i("br"),i("b",[e._v("Подъезд:")]),e._v(" "+e._s(t.item.entrance)+"\n                    "),i("br"),i("b",[e._v("Квартира:")]),e._v(" "+e._s(t.item.flat)+"\n                    "),i("br"),i("b",[e._v("Этаж:")]),e._v(" "+e._s(t.item.floor)+"\n                    "),i("br"),i("b",[e._v("№ заказа:")]),e._v(" "+e._s(t.item.id)+"\n                    "),i("br"),i("b",[e._v("Инкогнито:")]),e._v(" "+e._s(t.item.incognito?"Да":"Нет")+"\n                    "),i("br"),i("b",[e._v("Стоимость:")]),e._v(" "+e._s(t.item.orderCost)+"\n                    "),i("br"),i("b",[e._v("Т/С:")]),e._v(" "+e._s(t.item.orderSourceTypesStr)+"\n                    "),i("br"),i("b",[e._v("Статус:")]),e._v(" "+e._s(t.item.orderStatusStr)+"\n                  ")])],1)]}}])})]:e._e()],2)],1)],1),i("v-card-actions",{staticClass:"px-4 py-2"},[i("v-btn",{nativeOn:{click:function(t){e.cancel()}}},[e._v("Отмена")]),i("v-spacer"),e.editedItemReadOnly?e._e():i("v-btn",{attrs:{color:"info"},on:{click:e.submitForm}},[e._v("Сохранить")])],1)],1)],1)},n=[],o=i("e151"),d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-text-field",{ref:"autocomplete",staticClass:"mb-4",attrs:{label:"Адрес",value:e.address,"hide-details":"",rules:[function(e){return!!e||"Заполните поле"}],readonly:e.readonly,placeholder:"Введите местоположение"},on:{input:function(t){e.setPrefix(t)}}})},l=[],c={name:"AutocompleteAddress",props:{value:{type:String,required:!0},readonly:{type:Boolean,required:!0}},data:function(){return{address:"",autocomplete:null,bounds:null}},methods:{setPrefix:function(e){var t=e;this.address="".concat(t),this.$emit("change",{address:this.address,geo:[]})}},created:function(){this.address=this.value.length>0?this.value:""},mounted:function(){var e=this;this.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(50.00615400000004,50.39000009999995),new google.maps.LatLng(53.090497,53.43131899999999));var t=this.$refs.autocomplete.$refs.input;this.autocomplete=new google.maps.places.Autocomplete(t,{bounds:this.bounds,types:["address"],componentRestrictions:{country:"ru"}}),this.autocomplete.addListener("place_changed",function(){var t=e.autocomplete.getPlace(),i=t.address_components,r=t.geometry.location.lat(),a=t.geometry.location.lng(),s={country:null,state:null,city:null,postalCode:null,street:null,streetNumber:null,geo:[r,a]};if(void 0!==t.address_components){for(var n=0;n<i.length;n+=1){var o=i[n].types[0];switch(o){case"country":s.country=i[n].long_name;break;case"administrative_area_level_1":s.state=i[n].long_name;break;case"locality":s.city=i[n].long_name;break;case"postal_code":s.postalCode=i[n].long_name;break;case"route":s.street=i[n].short_name;break;case"street_number":s.streetNumber=i[n].long_name;break;default:break}}e.address="г. ".concat(s.city,", ").concat(s.street," ").concat(s.streetNumber),e.$emit("change",{address:e.address,geo:s.geo})}})}},u=c,m=i("2877"),f=Object(m["a"])(u,d,l,!1,null,null,null),p=f.exports;function v(e,t){return b(e)||h(e,t)||y()}function y(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function h(e,t){var i=[],r=!0,a=!1,s=void 0;try{for(var n,o=e[Symbol.iterator]();!(r=(n=o.next()).done);r=!0)if(i.push(n.value),t&&i.length===t)break}catch(d){a=!0,s=d}finally{try{r||null==o["return"]||o["return"]()}finally{if(a)throw s}}return i}function b(e){if(Array.isArray(e))return e}var g={components:{yandexMap:o["yandexMap"],ymapMarker:o["ymapMarker"],AutocompleteAddress:p},props:{id:{type:Number,required:!0},editedItemReadOnly:{type:Boolean,default:!1},copy:{type:Boolean,default:!1},orderSourceType:{type:Array,required:!0}},data:function(){return{clientAddressee:!1,dataPicker:!1,editedItem:{},createdSuccess:!1,userInfo:{},tsList:[],deliveryList:[],statusList:[],clientsList:[],typeClient:[],couriersList:[],ordersList:[],history:[],showHistory:!1,headersTableHistory:[{text:"Дата",align:"left",value:"updated_at"},{text:"Пользователь",align:"left",value:"user"}],pagination:{sortBy:"updated_at",descending:!0,rowsPerPage:-1},expand:!1,loadOrder:!0,deliveryTimeOfDayList:[{name:"Утро",id:1},{name:"День",id:2},{name:"Вечер",id:3}]}},computed:{placemarks:function(){var e=this,t=[];return this.ordersList.forEach(function(i){2===i.coordinates.length&&t.push({coords:i.coordinates,properties:{balloonContent:"".concat(i.deliveryDate,",\n                ").concat(i.deliveryTime,"\n                (").concat(e.deliveryTimeOfDayList.find(function(e){return e.id===+i.deliveryTimeOfDay}).name,")\n                <br>").concat(i.address,"\n              ")},options:{},clusterName:"1"})}),t}},methods:{clientsFilter:function(e,t){var i=e.name.toLowerCase(),r=e.phone.replace(/[^0-9]/gim,""),a=t.toLowerCase();return i.indexOf(a)>-1||r.indexOf(a)>-1},setDataClient:function(){var e=this.editedItem.client,t=this.clientsList.find(function(t){return t.id===e});void 0!==t?(this.editedItem.clientName=t.name,this.editedItem.clientPhone=t.phone,void 0!==t.type&&(this.editedItem.clientType=t.type)):(this.editedItem.clientName="",this.editedItem.clientPhone="",this.editedItem.clientType="")},setDataAddressee:function(){var e=this.editedItem.addressee,t=this.clientsList.find(function(t){return t.id===e});void 0!==t?(this.editedItem.addresseeName=t.name,this.editedItem.addresseePhone=t.phone):(this.editedItem.addresseeName="",this.editedItem.addresseePhone="")},updateAddress:function(e){this.editedItem.address=e.address,this.editedItem.coordinates=e.geo},getItem:function(){var e=this;if(this.id){var t={type:"orders",id:this.id};this.$store.dispatch("getItem",t).then(function(t){var i=t;e.usersList=i.createdBy;var r=[];Array.isArray(e.orderSourceType)&&(r=e.orderSourceType.map(function(e){return e.id})),i.orderSourceType=r,i.addressee=i.addressee?+i.addressee.id:null,i.client=i.client?+i.client.id:0,i.createdBy=i.createdBy?+i.createdBy.id:0,i.clientType=i.clientType?+i.clientType.id:0,i.deliveryType=i.deliveryType?+i.deliveryType.id:0,i.bouquets=i.bouquets?i.bouquets:[],e.copy?(i.orderStatus=1,i.courier=null,i.deliveryTimeOfDay=1,i.deliveryTime="",i.deliveryDate=""):(i.orderStatus=i.orderStatus?+i.orderStatus.id:0,i.courier=i.courier?+i.courier.id:null,i.deliveryTimeOfDay=+i.deliveryTimeOfDay),e.copy&&(i.bouquets=i.bouquets.map(function(e){var t=e;return delete t.id,t}),i.courier=null),e.editedItem=i,e.getOrdersList(),e.getUsersList(),e.loadOrder=!1}).catch(function(){console.log("error")})}},getItemHistory:function(){var e=this;if(this.id){var t={type:"orders",id:"".concat(this.id,"/history")};this.$store.dispatch("getItem",t).then(function(t){e.history=t.map(function(t){var i=t,r=new Date(i.updated_at);i.updated_atStr=r.toLocaleString("ru",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),r=new Date(i.created_at),i.created_atStr=r.toLocaleString("ru",{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),r=new Date(i.deliveryDate),i.deliveryDateStr=r.toLocaleString("ru",{day:"numeric",month:"long",year:"numeric"});var a=e.typeClient.find(function(e){return e.id===+i.clientTypeId});i.clientTypeStr=a?a.name:i.clientTypeId;var s=e.couriersList.find(function(e){return e.id===+i.courierId});i.courierStr=s?s.name:i.courierId;var n=e.deliveryList.find(function(e){return e.id===+i.deliveryTypeId});i.deliveryTypeStr=n?n.name:i.deliveryTypeId;var o=e.statusList.find(function(e){return e.id===+i.orderStatusId});return i.orderStatusStr=o?o.name:i.orderStatusId,i.orderSourceTypesStr=i.orderSourceTypeIds.map(function(t){var i=e.tsList.find(function(e){return e.id===+t});return i?i.name:t}),i})}).catch(function(){console.log("error")})}},getTsList:function(){var e=this,t={type:"order-source"};this.$store.dispatch("getItemsList",t).then(function(t){e.tsList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getDeliveryList:function(){var e=this,t={type:"delivery-type"};this.$store.dispatch("getItemsList",t).then(function(t){e.deliveryList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getStatusList:function(){var e=this,t={type:"order-status"};this.$store.dispatch("getItemsList",t).then(function(t){e.statusList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getClientsList:function(){var e=this,t={type:"clients",filter:{active:!0}};this.$store.dispatch("getItemsList",t).then(function(t){e.clientsList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getClientTypeList:function(){var e=this,t={type:"client-type"};this.$store.dispatch("getItemsList",t).then(function(t){e.typeClient=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getCouriersList:function(){var e=this,t={type:"couriers",filter:{isActive:!0}};this.$store.dispatch("getItemsList",t).then(function(t){e.couriersList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getOrdersList:function(){var e=this,t={type:"orders",filter:{deliveryDate:this.editedItem.deliveryDate,deliveryTimeOfDay:this.editedItem.deliveryTimeOfDay,deliveryType:2,orderStatus:[1,2,3]}};this.$store.dispatch("getItemsList",t).then(function(t){e.ordersList=t.orders}).catch(function(){console.log("error")})},getUsersList:function(){var e=this,t={};this.copy?t.type="login":(t.type="users",t.filter={id:+this.editedItem.createdBy}),this.$store.dispatch("getItemsList",t).then(function(t){var i={};if(e.copy)i=t;else{var r=v(t,1);i=r[0]}e.userInfo=i,e.userInfo.id=+e.userInfo.id,e.editedItem.createdBy=+e.userInfo.id}).catch(function(){console.log("error")})},cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},submitForm:function(){var e=this,t=this.$refs.form.validate();if(t){var i=Object.assign({},this.editedItem);delete i.id,i.delivery=!1;var r={type:"orders",props:i},a="updateItem";this.copy?a="addItem":r.id=this.id,this.$store.dispatch(a,r).then(function(){e.createdSuccess=!0,setTimeout(function(){e.$emit("cancel")},1e3)})}},bouquetAdd:function(){this.editedItem.bouquets.push({name:null,count:null})},bouquetDelete:function(e){this.editedItem.bouquets.splice(e,1)}},mounted:function(){this.getClientsList(),this.getTsList(),this.getDeliveryList(),this.getStatusList(),this.getClientTypeList(),this.getCouriersList(),this.getItem(),this.getItemHistory()}},I=g,x=(i("2748"),Object(m["a"])(I,s,n,!1,null,null,null)),k=x.exports,_=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticClass:"order"},[i("v-alert",{staticClass:"my-0",attrs:{value:e.createdSuccess,type:"success"}},[e._v("Заказ создан")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4 py-2"},[i("span",{staticClass:"headline"},[e._v("Создание заказа")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4 pt-1"},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{staticStyle:{"padding-right":"15px"},attrs:{xs7:2===e.editedItem.deliveryType}},[i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs6:2===e.editedItem.deliveryType}},[i("v-select",{attrs:{label:"КТО",items:[e.userInfo],rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",readonly:""},model:{value:e.editedItem.createdBy,callback:function(t){e.$set(e.editedItem,"createdBy",e._n(t))},expression:"editedItem.createdBy"}}),i("v-select",{staticClass:"mb-4",attrs:{label:"Т/С",items:e.tsList,rules:[function(e){return e.length>0||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":"",chips:"",multiple:""},model:{value:e.editedItem.orderSourceType,callback:function(t){e.$set(e.editedItem,"orderSourceType",t)},expression:"editedItem.orderSourceType"}}),i("v-select",{staticClass:"mb-4",attrs:{label:"Способ доставки",items:e.deliveryList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},on:{change:function(t){e.editedItem.delivery=2===t}},model:{value:e.editedItem.deliveryType,callback:function(t){e.$set(e.editedItem,"deliveryType",e._n(t))},expression:"editedItem.deliveryType"}}),2!==e.editedItem.deliveryType?i("v-menu",{staticClass:"mb-2",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:e.dataPicker,callback:function(t){e.dataPicker=t},expression:"dataPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"Дата доставки",rules:[function(e){return!!e||"Заполните поле"}],"prepend-icon":"event","hide-details":"",readonly:""},slot:"activator",model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1"},on:{input:function(t){e.dataPicker=!1}},model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}})],1):e._e(),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs7:""}},[2!==e.editedItem.deliveryType?i("v-text-field",{staticClass:"mb-4",attrs:{label:"Время доставки",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":""},model:{value:e.editedItem.deliveryTime,callback:function(t){e.$set(e.editedItem,"deliveryTime",t)},expression:"editedItem.deliveryTime"}}):e._e()],1),i("v-flex",{attrs:{xs5:""}},[2!==e.editedItem.deliveryType?i("v-select",{staticClass:"mb-4",attrs:{label:"Время суток",items:e.deliveryTimeOfDayList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},model:{value:e.editedItem.deliveryTimeOfDay,callback:function(t){e.$set(e.editedItem,"deliveryTimeOfDay",e._n(t))},expression:"editedItem.deliveryTimeOfDay"}}):e._e()],1)],1),i("v-select",{staticClass:"mb-4",attrs:{label:"Статус",items:e.statusList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},model:{value:e.editedItem.orderStatus,callback:function(t){e.$set(e.editedItem,"orderStatus",e._n(t))},expression:"editedItem.orderStatus"}}),i("v-autocomplete",{staticClass:"mb-4",attrs:{label:"Клиент",items:e.clientsList,filter:e.clientsFilter,"item-text":"name","item-value":"id","hide-details":"","no-data-text":"Не надено",clearable:""},on:{change:function(t){e.setDataClient()}},model:{value:e.editedItem.client,callback:function(t){e.$set(e.editedItem,"client",e._n(t))},expression:"editedItem.client"}}),i("v-select",{staticClass:"mb-4",attrs:{label:"Тип клиента",items:e.typeClient,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},model:{value:e.editedItem.clientType,callback:function(t){e.$set(e.editedItem,"clientType",e._n(t))},expression:"editedItem.clientType"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Имя",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":""},model:{value:e.editedItem.clientName,callback:function(t){e.$set(e.editedItem,"clientName",t)},expression:"editedItem.clientName"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Телефон",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":""},model:{value:e.editedItem.clientPhone,callback:function(t){e.$set(e.editedItem,"clientPhone",t)},expression:"editedItem.clientPhone"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Сумма","hide-details":"",placeholder:"0"},model:{value:e.editedItem.orderCost,callback:function(t){e.$set(e.editedItem,"orderCost",t)},expression:"editedItem.orderCost"}})],1),2===e.editedItem.deliveryType?i("v-flex",{staticStyle:{"padding-left":"15px"},attrs:{xs6:""}},[3===e.editedItem.orderStatus?i("v-select",{staticClass:"mb-4",attrs:{label:"Курьер",items:e.couriersList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","no-data-text":"Не надено","hide-details":""},model:{value:e.editedItem.courier,callback:function(t){e.$set(e.editedItem,"courier",e._n(t))},expression:"editedItem.courier"}}):e._e(),i("v-menu",{staticClass:"mb-2",attrs:{"close-on-content-click":!1,"nudge-right":40,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},model:{value:e.dataPicker,callback:function(t){e.dataPicker=t},expression:"dataPicker"}},[i("v-text-field",{attrs:{slot:"activator",label:"Дата доставки",rules:[function(e){return!!e||"Заполните поле"}],"prepend-icon":"event","hide-details":"",readonly:""},slot:"activator",model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}}),i("v-date-picker",{attrs:{"no-title":"",scrollable:"",locale:"ru-ru","first-day-of-week":"1"},on:{input:function(t){e.dataPicker=!1},change:function(t){e.getOrdersList()}},model:{value:e.editedItem.deliveryDate,callback:function(t){e.$set(e.editedItem,"deliveryDate",t)},expression:"editedItem.deliveryDate"}})],1),i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{attrs:{xs7:""}},[i("v-text-field",{staticClass:"mb-4",attrs:{label:"Время доставки",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":""},model:{value:e.editedItem.deliveryTime,callback:function(t){e.$set(e.editedItem,"deliveryTime",t)},expression:"editedItem.deliveryTime"}})],1),i("v-flex",{attrs:{xs5:""}},[i("v-select",{staticClass:"mb-4",attrs:{label:"Время суток",items:e.deliveryTimeOfDayList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},on:{change:function(t){e.getOrdersList()}},model:{value:e.editedItem.deliveryTimeOfDay,callback:function(t){e.$set(e.editedItem,"deliveryTimeOfDay",e._n(t))},expression:"editedItem.deliveryTimeOfDay"}})],1)],1),i("v-checkbox",{staticClass:"mb-4",attrs:{label:"Инкогнито",color:"primary","hide-details":""},model:{value:e.editedItem.incognito,callback:function(t){e.$set(e.editedItem,"incognito",t)},expression:"editedItem.incognito"}}),i("v-checkbox",{staticClass:"mb-4",attrs:{label:"Заказчик-получатель",color:"primary","hide-details":""},model:{value:e.clientAddressee,callback:function(t){e.clientAddressee=t},expression:"clientAddressee"}}),e.clientAddressee?e._e():i("v-autocomplete",{staticClass:"mb-4",attrs:{label:"Получатель",items:e.clientsList,filter:e.clientsFilter,"item-text":"name","item-value":"id","hide-details":"","no-data-text":"Не надено",clearable:""},on:{change:function(t){e.setDataAddressee()}},model:{value:e.editedItem.addressee,callback:function(t){e.$set(e.editedItem,"addressee",e._n(t))},expression:"editedItem.addressee"}}),e.clientAddressee?e._e():i("v-text-field",{staticClass:"mb-4",attrs:{label:"Имя получателя","hide-details":""},model:{value:e.editedItem.addresseeName,callback:function(t){e.$set(e.editedItem,"addresseeName",t)},expression:"editedItem.addresseeName"}}),e.clientAddressee?e._e():i("v-text-field",{staticClass:"mb-4",attrs:{label:"Телефон получателя","hide-details":""},model:{value:e.editedItem.addresseePhone,callback:function(t){e.$set(e.editedItem,"addresseePhone",t)},expression:"editedItem.addresseePhone"}}),i("autocomplete-address",{attrs:{value:e.editedItem.address,readonly:!1},on:{change:function(t){e.updateAddress(t)}}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Квартира","hide-details":"",rules:[function(e){return!!e||"Заполните поле"}]},model:{value:e.editedItem.flat,callback:function(t){e.$set(e.editedItem,"flat",t)},expression:"editedItem.flat"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Подъезд","hide-details":"",rules:[function(e){return!!e||"Заполните поле"}]},model:{value:e.editedItem.entrance,callback:function(t){e.$set(e.editedItem,"entrance",t)},expression:"editedItem.entrance"}}),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Этаж","hide-details":"",rules:[function(e){return!!e||"Заполните поле"}]},model:{value:e.editedItem.floor,callback:function(t){e.$set(e.editedItem,"floor",t)},expression:"editedItem.floor"}})],1):e._e()],1),i("p",{staticClass:"mb-0"},[e._v("Букеты")]),e._l(e.editedItem.bouquets,function(t,r){return i("v-layout",{key:"bouquet-"+r,attrs:{row:"",wrap:"","align-center":""}},[i("v-flex",{staticClass:"pr-3",attrs:{xs9:""}},[i("v-textarea",{staticClass:"mb-4",attrs:{label:"Название",rules:[function(e){return!!e||"Заполните поле"}],"auto-grow":"","row-height":"6","hide-details":""},model:{value:t.name,callback:function(i){e.$set(t,"name",i)},expression:"bouquet.name"}})],1),i("v-flex",{staticClass:"pr-3",attrs:{xs2:""}},[i("v-text-field",{staticClass:"mb-4",attrs:{label:"Кол-во",rules:[function(e){return!!e||"Заполните поле"}],"hide-details":""},model:{value:t.count,callback:function(i){e.$set(t,"count",i)},expression:"bouquet.count"}})],1),i("v-flex",{attrs:{xs1:""}},[i("v-icon",{on:{click:function(t){e.bouquetDelete(r)}}},[e._v("\n                delete\n              ")])],1)],1)}),i("v-icon",{on:{click:function(t){e.bouquetAdd()}}},[e._v("\n            add\n          ")]),i("v-textarea",{staticClass:"my-4",attrs:{label:"Комментарий","auto-grow":"","row-height":"12","hide-details":""},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",t)},expression:"editedItem.description"}})],2),2===e.editedItem.deliveryType?i("v-flex",{attrs:{xs5:""}},[i("yandex-map",{staticStyle:{height:"100%"},attrs:{coords:[53.05,50.101783],zoom:"10",controls:["trafficControl"],placemarks:e.placemarks}})],1):e._e()],1)],1),i("v-card-actions",{staticClass:"px-4 py-2"},[i("v-btn",{nativeOn:{click:function(t){e.cancel()}}},[e._v("Отмена")]),i("v-spacer"),i("v-btn",{attrs:{color:"info"},on:{click:e.submitForm}},[e._v("Сохранить")])],1)],1)],1)},S=[],C={components:{yandexMap:o["yandexMap"],ymapMarker:o["ymapMarker"],AutocompleteAddress:p},data:function(){return{clientAddressee:!1,dataPicker:!1,editedItem:{client:0,clientName:"",clientPhone:"",courier:null,delivery:!1,deliveryDate:"",deliveryTime:"",deliveryTimeOfDay:1,createdBy:0,orderSourceType:[],description:"",orderCost:"",addressee:null,addresseeName:"",addresseePhone:"",address:"",entrance:"",flat:"",floor:"",orderStatus:1,clientType:1,deliveryType:1,incognito:!1,coordinates:[],bouquets:[{count:null,name:null}]},createdSuccess:!1,userInfo:{},tsList:[],deliveryList:[],statusList:[],clientsList:[],typeClient:[],couriersList:[],ordersList:[],deliveryTimeOfDayList:[{name:"Утро",id:1},{name:"День",id:2},{name:"Вечер",id:3}]}},computed:{placemarks:function(){var e=this,t=[];return this.ordersList.forEach(function(i){t.push({coords:i.coordinates,properties:{balloonContent:"".concat(i.deliveryDate,",\n              ").concat(i.deliveryTime,"\n              (").concat(e.deliveryTimeOfDayList.find(function(e){return e.id===+i.deliveryTimeOfDay}).name,")\n              <br>").concat(i.address,"\n            ")},options:{},clusterName:"1"})}),t}},methods:{clientsFilter:function(e,t){var i=e.name.toLowerCase(),r=e.phone.replace(/[^0-9]/gim,""),a=t.toLowerCase();return i.indexOf(a)>-1||r.indexOf(a)>-1},setDataClient:function(){var e=this.editedItem.client,t=this.clientsList.find(function(t){return t.id===e});void 0!==t?(this.editedItem.clientName=t.name,this.editedItem.clientPhone=t.phone,void 0!==t.type&&(this.editedItem.clientType=t.type)):(this.editedItem.clientName="",this.editedItem.clientPhone="",this.editedItem.clientType="")},setDataAddressee:function(){var e=this.editedItem.addressee,t=this.clientsList.find(function(t){return t.id===e});void 0!==t?(this.editedItem.addresseeName=t.name,this.editedItem.addresseePhone=t.phone):(this.editedItem.addresseeName="",this.editedItem.addresseePhone="")},updateAddress:function(e){this.editedItem.address=e.address,this.editedItem.coordinates=e.geo},getUsersList:function(){var e=this,t={type:"login"};this.$store.dispatch("getItemsList",t).then(function(t){e.userInfo=t,e.userInfo.id=+e.userInfo.id,e.editedItem.createdBy=+e.userInfo.id}).catch(function(){console.log("error")})},getTsList:function(){var e=this,t={type:"order-source"};this.$store.dispatch("getItemsList",t).then(function(t){e.tsList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getDeliveryList:function(){var e=this,t={type:"delivery-type"};this.$store.dispatch("getItemsList",t).then(function(t){e.deliveryList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getStatusList:function(){var e=this,t={type:"order-status"};this.$store.dispatch("getItemsList",t).then(function(t){e.statusList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getClientsList:function(){var e=this,t={type:"clients",filter:{isActive:!0}};this.$store.dispatch("getItemsList",t).then(function(t){e.clientsList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getClientTypeList:function(){var e=this,t={type:"client-type"};this.$store.dispatch("getItemsList",t).then(function(t){e.typeClient=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getCouriersList:function(){var e=this,t={type:"couriers",filter:{isActive:!0}};this.$store.dispatch("getItemsList",t).then(function(t){e.couriersList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getOrdersList:function(){var e=this,t={type:"orders",filter:{deliveryDate:this.editedItem.deliveryDate,deliveryTimeOfDay:this.editedItem.deliveryTimeOfDay,deliveryType:2,status:[1,2,3]}};this.$store.dispatch("getItemsList",t).then(function(t){e.ordersList=t.orders}).catch(function(){console.log("error")})},cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},submitForm:function(){var e=this.$refs.form.validate();e&&(this.editedItem.client?this.addOrder():this.addClient())},addOrder:function(){var e=this,t=Object.assign({},this.editedItem);delete t.id,t.delivery=!1;var i={type:"orders",props:t};this.$store.dispatch("addItem",i).then(function(){e.createdSuccess=!0,setTimeout(function(){e.$emit("cancel")},1e3)})},addClient:function(){var e=this,t={type:"clients",props:{name:this.editedItem.clientName,birthDay:"1900-01-01",bill:0,sale:0,phone:this.editedItem.clientPhone,isActive:!0,type:this.editedItem.clientType}};this.$store.dispatch("addItem",t).then(function(t){e.editedItem.client=t.id,e.addOrder()})},bouquetAdd:function(){this.editedItem.bouquets.push({name:null,count:null})},bouquetDelete:function(e){this.editedItem.bouquets.splice(e,1)}},mounted:function(){this.getUsersList(),this.getTsList(),this.getDeliveryList(),this.getStatusList(),this.getClientsList(),this.getClientTypeList(),this.getCouriersList()}},T=C,O=(i("4151"),Object(m["a"])(T,_,S,!1,null,null,null)),L=O.exports,w=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",[i("v-alert",{staticClass:"my-0",attrs:{value:e.createdSuccess,type:"success"}},[e._v("Статус изменен")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4 py-2"},[i("span",{staticClass:"headline"},[e._v("Изменение статуса")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4 py-1"},[i("v-select",{staticClass:"mb-4",attrs:{label:"Статус",items:e.statusList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","hide-details":""},model:{value:e.editedItem.orderStatus,callback:function(t){e.$set(e.editedItem,"orderStatus",e._n(t))},expression:"editedItem.orderStatus"}}),3===e.editedItem.orderStatus&&2===e.editedItem.deliveryType?i("v-select",{staticClass:"mb-4",attrs:{label:"Курьер",items:e.couriersList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"id","no-data-text":"Не надено","hide-details":""},model:{value:e.editedItem.courier,callback:function(t){e.$set(e.editedItem,"courier",e._n(t))},expression:"editedItem.courier"}}):e._e()],1),i("v-card-actions",{staticClass:"px-4 pb-4"},[i("v-btn",{nativeOn:{click:function(t){e.cancel()}}},[e._v("Отмена")]),i("v-spacer"),i("v-btn",{attrs:{color:"info"},on:{click:e.submitForm}},[e._v("Сохранить")])],1)],1)],1)},D=[],$={props:{id:{type:Number,required:!0},orderSourceType:{type:Array,required:!0}},data:function(){return{editedItem:{},createdSuccess:!1,statusList:[],couriersList:[]}},methods:{getItem:function(){var e=this;if(this.id){var t={type:"orders",id:this.id};this.$store.dispatch("getItem",t).then(function(t){var i=t;e.usersList=i.createdBy;var r=[];Array.isArray(e.orderSourceType)&&(r=e.orderSourceType.map(function(e){return e.id})),i.orderSourceType=r,i.addressee=i.addressee?+i.addressee.id:null,i.client=i.client?+i.client.id:0,i.courier=i.courier?+i.courier.id:null,i.createdBy=i.createdBy?+i.createdBy.id:0,i.orderStatus=i.orderStatus?+i.orderStatus.id:0,i.clientType=i.clientType?+i.clientType.id:0,i.deliveryType=i.deliveryType?+i.deliveryType.id:0,i.orderCost=i.orderCost?String(i.orderCost):"",i.deliveryTimeOfDay=+i.deliveryTimeOfDay,e.editedItem=i}).catch(function(){console.log("error")})}},getStatusList:function(){var e=this,t={type:"order-status"};this.$store.dispatch("getItemsList",t).then(function(t){e.statusList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getCouriersList:function(){var e=this,t={type:"couriers",filter:{isActive:!0}};this.$store.dispatch("getItemsList",t).then(function(t){e.couriersList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},submitForm:function(){var e=this,t=this.$refs.form.validate();if(t){var i=Object.assign({},this.editedItem);delete i.id;var r={type:"orders",props:i},a="updateItem";this.copy?a="addItem":r.id=this.id,this.$store.dispatch(a,r).then(function(){e.createdSuccess=!0,setTimeout(function(){e.$emit("cancel")},1e3)})}}},mounted:function(){this.getStatusList(),this.getCouriersList(),this.getItem()}},N=$,A=Object(m["a"])(N,w,D,!1,null,null,null),F=A.exports,P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",[i("v-alert",{staticClass:"my-0",attrs:{value:e.createdSuccess,type:"success"}},[e._v("Комментарий изменен")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4 py-2"},[i("span",{staticClass:"headline"},[e._v("Изменение комментария")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4 py-1"},[i("v-textarea",{staticClass:"mb-4",attrs:{label:"Комментарий","auto-grow":"",rules:[function(e){return!!e||"Заполните поле"}],"row-height":"12","hide-details":""},model:{value:e.editedItem.description,callback:function(t){e.$set(e.editedItem,"description",e._n(t))},expression:"editedItem.description"}})],1),i("v-card-actions",{staticClass:"px-4 pb-4"},[i("v-btn",{nativeOn:{click:function(t){e.cancel()}}},[e._v("Отмена")]),i("v-spacer"),i("v-btn",{attrs:{color:"info"},on:{click:e.submitForm}},[e._v("Сохранить")])],1)],1)],1)},E=[],M={props:{id:{type:Number,required:!0},orderSourceType:{type:Array,required:!0}},data:function(){return{editedItem:{},createdSuccess:!1}},methods:{getItem:function(){var e=this;if(this.id){var t={type:"orders",id:this.id};this.$store.dispatch("getItem",t).then(function(t){var i=t,r=[];Array.isArray(e.orderSourceType)&&(r=e.orderSourceType.map(function(e){return e.id})),i.orderSourceType=r,i.addressee=i.addressee?+i.addressee.id:null,i.client=i.client?+i.client.id:0,i.courier=i.courier?+i.courier.id:null,i.createdBy=i.createdBy?+i.createdBy.id:0,i.orderStatus=i.orderStatus?+i.orderStatus.id:0,i.clientType=i.clientType?+i.clientType.id:0,i.deliveryType=i.deliveryType?+i.deliveryType.id:0,i.orderCost=i.orderCost?String(i.orderCost):"",i.deliveryTimeOfDay=+i.deliveryTimeOfDay,e.editedItem=i}).catch(function(){console.log("error")})}},cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},submitForm:function(){var e=this,t=this.$refs.form.validate();if(t){var i=Object.assign({},this.editedItem);delete i.id;var r={type:"orders",props:i},a="updateItem";this.copy?a="addItem":r.id=this.id,this.$store.dispatch(a,r).then(function(){e.createdSuccess=!0,setTimeout(function(){e.$emit("cancel")},1e3)})}}},mounted:function(){this.getItem()}},j=M,B=Object(m["a"])(j,P,E,!1,null,null,null),q=B.exports,R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticClass:"order"},[i("v-alert",{staticClass:"my-0",attrs:{value:e.createdSuccess,type:"success"}},[e._v("Сохранено")]),i("v-form",{ref:"form",attrs:{"lazy-validation":""}},[i("v-card-title",{staticClass:"px-4 py-2"},[i("span",{staticClass:"headline"},[e._v("Настройки")])]),i("v-divider"),i("v-card-text",{staticClass:"px-4 pt-1"},[i("div",{staticStyle:{overflow:"auto"}},[i("v-layout",{attrs:{row:"",nowrap:""}},[e._l(e.settings.orderSettings,function(t,r){return[i("v-flex",{key:"col-"+r,staticClass:"mb-5",staticStyle:{"flex-shrink":"0","flex-basis":"350px","max-width":"350px"},attrs:{"px-1":""}},[i("v-layout",{attrs:{row:"",wrap:"","align-center":""}},[i("v-flex",{attrs:{xs10:""}},[i("v-text-field",{staticClass:"mb-2",attrs:{label:"Название столбца","hide-details":""},model:{value:t.columnName,callback:function(i){e.$set(t,"columnName",i)},expression:"col.columnName"}})],1),i("v-flex",{attrs:{xs2:""}},[i("v-btn",{attrs:{small:"",color:"error"},on:{click:function(t){e.delCol(r)}}},[i("v-icon",{attrs:{dark:""}},[e._v("delete")])],1)],1)],1),i("v-layout",{attrs:{row:"",wrap:"","align-center":""}},[i("v-flex",{attrs:{xs8:""}},[i("v-select",{staticClass:"mb-2",attrs:{label:"Свойство",items:e.propsList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"code","hide-details":""},model:{value:t.sortField,callback:function(i){e.$set(t,"sortField",e._n(i))},expression:"col.sortField"}})],1),i("v-flex",{attrs:{xs4:""}},[i("v-select",{staticClass:"mb-2",attrs:{label:"Сортировать",items:e.sortOrder,"item-text":"name","item-value":"code","hide-details":""},model:{value:t.sortOrder,callback:function(i){e.$set(t,"sortOrder",e._n(i))},expression:"col.sortOrder"}})],1),i("v-flex",{attrs:{xs12:""}},[i("v-text-field",{staticClass:"mb-4",attrs:{label:"Ширина столбца","hide-details":""},model:{value:t.width,callback:function(i){e.$set(t,"width",e._n(i))},expression:"col.width"}})],1)],1),e._l(t.dataFields,function(t,a){return[i("v-card",{key:"prop-"+r+"-"+a,staticClass:"mb-2"},[i("v-card-text",[i("v-layout",{attrs:{row:"",wrap:"","align-center":""}},[i("v-flex",{attrs:{xs10:""}},[i("v-select",{staticClass:"mb-4",attrs:{label:"Свойство",items:e.propsList,rules:[function(e){return!!e||"Заполните поле"}],"item-text":"name","item-value":"code","hide-details":""},model:{value:t.field,callback:function(i){e.$set(t,"field",e._n(i))},expression:"prop.field"}})],1),i("v-flex",{attrs:{xs2:""}},[i("v-btn",{attrs:{small:"",color:"error"},on:{click:function(t){e.delProp(r,a)}}},[i("v-icon",{attrs:{dark:""}},[e._v("delete")])],1)],1)],1),i("v-text-field",{staticClass:"mb-4",attrs:{label:"Название свойства в таблице","hide-details":""},model:{value:t.displayName,callback:function(i){e.$set(t,"displayName",i)},expression:"prop.displayName"}})],1)],1)]}),i("v-btn",{attrs:{fab:"",color:"info"},on:{click:function(t){e.addProp(r)}}},[i("v-icon",{attrs:{dark:""}},[e._v("add")])],1)],2)]}),i("v-flex",{attrs:{xs2:"","px-1":""}},[i("v-btn",{attrs:{fab:"",color:"info"},on:{click:function(t){e.addCol()}}},[i("v-icon",{attrs:{dark:""}},[e._v("add")])],1)],1)],2)],1)]),i("v-card-actions",{staticClass:"px-4 py-2"},[i("v-btn",{nativeOn:{click:function(t){e.cancel()}}},[e._v("Отмена")]),i("v-spacer"),i("v-btn",{attrs:{color:"info"},on:{click:e.submitForm}},[e._v("Сохранить")])],1)],1)],1)},z=[],H={props:{userSettings:{type:Array,required:!0}},data:function(){return{settings:{orderSettings:[]},propsList:[{code:"clientName",name:"Имя клиента"},{code:"clientPhone",name:"Телефон клиента"},{code:"clientType",name:"Тип клиента"},{code:"courier",name:"Курьер"},{code:"deliveryType",name:"Тип доставки"},{code:"deliveryDate",name:"Дата доставки"},{code:"deliveryTime",name:"Время доставки"},{code:"deliveryTimeOfDay",name:"Время суток"},{code:"createdAt",name:"Дата создания заказа"},{code:"createdBy",name:"Создатель заказа"},{code:"orderStatus",name:"Статус заказа"},{code:"orderSourceType",name:"Т/С"},{code:"id",name:"Номер заказа"},{code:"orderCost",name:"Сумма заказа"},{code:"addresseeName",name:"Имя получателя"},{code:"addresseePhone",name:"Телефон получателя"},{code:"address",name:"Адрес"},{code:"entrance",name:"Подъезд"},{code:"flat",name:"Квартира"},{code:"floor",name:"Этаж"},{code:"incognito",name:"Инкогнито"},{code:"description",name:"Комментарий"},{code:"bouquets",name:"Букеты"}],sortOrder:[{name:"Нет",code:""},{name:"↑",code:"asc"},{name:"↓",code:"desc"}],createdSuccess:!1}},methods:{cancel:function(){this.editedItem={},this.createdSuccess=!1,this.$emit("cancel")},addCol:function(){var e={id:this.settings.orderSettings.length+1,columnName:"",sortField:"",sortOrder:"",width:100,dataFields:[]};this.settings.orderSettings.push(e)},delCol:function(e){this.settings.orderSettings.splice(e,1)},addProp:function(e){var t={id:this.settings.orderSettings.length+1,field:"",displayName:""};this.settings.orderSettings[e].dataFields.push(t)},delProp:function(e,t){this.settings.orderSettings[e].dataFields.splice(t,1)},submitForm:function(){var e=this,t=this.$refs.form.validate();if(t){var i={type:"users/".concat(this.$store.getters.getAuthUser,"/settings"),props:{settings:this.settings}};this.$store.dispatch("addItem",i).then(function(){e.createdSuccess=!0,setTimeout(function(){e.$emit("cancel")},1e3)})}}},mounted:function(){this.settings.orderSettings=this.userSettings}},W=H,U=(i("442c"),Object(m["a"])(W,R,z,!1,null,null,null)),Z=U.exports,J={name:"Orders",components:{OrderEdit:k,OrderAdd:L,ChangeStatus:F,changeDescription:q,userSettings:Z},data:function(){return{filter:{orderStatus:"",client:"",deliveryTimeOfDay:"",dateStart:null,dateEnd:null},loadingData:[{title:"Получение заказов",error:!1,loading:!0,color:"amber",id:"orders"}],dataStartPicker:!1,dataEndPicker:!1,search:"",dialogForm:!1,ordersList:[],statusList:[],clientsList:[],typeClient:[],editedId:0,copyElem:!1,editStatus:!1,editDescription:!1,editSettings:!1,dataNowStr:"",deliveryNow:0,deliveryPrinted:[],floristPrinted:[],selectedOrders:[],deliveryTimeOfDayList:{1:"Утро",2:"День",3:"Вечер"},userSettings:[],pagination:{rowsPerPage:-1},deliveryTimeOfDayFilter:[{name:"Утро",id:1},{name:"День",id:2},{name:"Вечер",id:3}]}},watch:{dialogForm:function(e){e||this.closeDialog()}},computed:{loadingDialog:function(){var e=this.loadingData.filter(function(e){return!e.error&&!e.loading});return e.length===this.loadingData.length?0:1},orderSourceTypeEditElem:function(){var e=this,t=this.ordersList.find(function(t){return t.id===e.editedId});return t?t.orderSourceType:[]},headersTable:function(){var e=this.userSettings.map(function(e){var t={text:e.columnName,align:"left",value:e.sortField,width:e.width};return t}),t={text:"",align:"right",sortable:!1,value:"action"};return e.push(t),e},colsTable:function(){var e=this.userSettings.map(function(e){var t={width:e.width,dataFields:e.dataFields};return t});return e},printOrdersIds:function(){return this.selectedOrders.map(function(e){return e.id})}},methods:{printOrders:function(e){var t=this.selectedOrders.map(function(e){return e.id});"delivery"===e?this.$router.push({name:"ordersDelivery",params:{ids:t}}):"florist"===e&&this.$router.push({name:"ordersFlorist",params:{ids:t}})},printDoc:function(e,t){var i=window.location,r=i.protocol,a=i.hostname,s="".concat(r,"//").concat(a,"/print/order/").concat(e,"/").concat(t);window.open(s,"_blank")},printDayOrders:function(){var e=new Date,t=e.toISOString().split("T")[0],i=window.location,r=i.protocol,a=i.hostname,s="".concat(r,"//").concat(a,"/print/day-orders/").concat(t);window.open(s,"_blank")},customFilter:function(){this.getOrdersList()},clientsFilter:function(e,t){var i=e.name.toLowerCase(),r=e.phone.replace(/[^0-9]/gim,""),a=t.toLowerCase();return i.indexOf(a)>-1||r.indexOf(a)>-1},getOrdersList:function(){var e=this,t={deliveryDate:[]};Object.keys(this.filter).forEach(function(i){var r=e.filter[i];r&&("dateStart"===i?t.deliveryDate[0]="".concat(r):"dateEnd"===i?t.deliveryDate[1]="".concat(r):t[i]=r)});var i={type:"orders",sort:{deliveryDate:"desc",deliveryTimeOfDay:"asc"},filter:t},r="Заказы получены!",a="Ошибка получения заказов!";this.$store.dispatch("getItemsList",i).then(function(t){var a="";e.ordersList=t.orders.map(function(e){var t=e;if(a!==t.deliveryDate?(t.topLine=!0,a=t.deliveryDate):t.topLine=!1,t.createdAt){var i=new Date(t.createdAt);t.createdAt=i.toLocaleString("ru",{day:"numeric",month:"numeric"})}if(t.deliveryDate){var r=new Date(t.deliveryDate);t.deliveryDateStr=r.toLocaleString("ru",{day:"numeric",month:"numeric",weekday:"long"})}return t.deliveryTimeOfDay=+t.deliveryTimeOfDay,t});var s=t.settings;if(e.userSettings=s||[],s){var n=e.userSettings.find(function(e){return e.sortOrder});n&&(e.pagination.sortBy=n.sortField,e.pagination.descending="desc"===n.sortOrder)}var o=e.loadingData.find(function(e){return e.id===i.type});o.title=r,o.loading=!1,e.getDeliveryNow()}).catch(function(){var t=e.loadingData.find(function(e){return e.id===i.type});t.title=a,t.error=!0})},getDeliveryNow:function(){var e=this,t={deliveryDate:[this.dateNowStr,this.dateNowStr],deliveryType:2},i={type:"orders",sort:{deliveryDate:"desc"},filter:t};this.$store.dispatch("getItemsList",i).then(function(t){e.deliveryNow=t.orders.length}).catch(function(){console.log("error")})},getStatusList:function(){var e=this,t={type:"order-status"};this.$store.dispatch("getItemsList",t).then(function(t){e.statusList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getClientsList:function(){var e=this,t={type:"clients",filter:{active:!0}};this.$store.dispatch("getItemsList",t).then(function(t){e.clientsList=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},getClientTypeList:function(){var e=this,t={type:"client-type"};this.$store.dispatch("getItemsList",t).then(function(t){e.typeClient=t.map(function(e){return e.id=+e.id,e})}).catch(function(){console.log("error")})},closeDialog:function(){var e=this;this.getOrdersList(),this.dialogForm=!1,this.copyElem=!1,this.editedId=0,setTimeout(function(){e.editStatus=!1,e.editDescription=!1,e.editSettings=!1},300)},editItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.editedId=+e,this.copyElem=t,this.dialogForm=!0},changeStatus:function(e){this.editedId=+e,this.editStatus=!0,this.dialogForm=!0},changeDescription:function(e){this.editedId=+e,this.editDescription=!0,this.dialogForm=!0},changeSettings:function(){this.editSettings=!0,this.dialogForm=!0},createdBouquet:function(e){var t=JSON.parse(localStorage.getItem("cardsList"));t=null!==t?t:[];var i=t.findIndex(function(t){return t.props.order===e.id});-1===i?t.push({sum:0,success:!1,props:{floristId:null,orderId:e.id,clientId:e.client.id,decorPercent:10,deliveryCost:0,salePercent:0},goods:[]}):t[i].props.clientId=e.client.id,localStorage.setItem("cardsList",JSON.stringify(t)),this.$router.push({path:"/",query:{selectOrder:e.id}})},getWeekEndDate:function(){var e=new Date,t=7-e.getDay();return t<0&&(t+=6),e.setDate(e.getDate()+1*t),e.toISOString().split("T")[0]},getWeekStartDate:function(){var e=new Date,t=e.getDay()-8;return t<0&&(t+=7),e.setDate(e.getDate()+-1*t),e.toISOString().split("T")[0]},setFilterDateNow:function(){this.filter.dateStart=this.dateNowStr,this.filter.dateEnd=this.dateNowStr,this.getOrdersList()},setFilterDateWeek:function(){this.filter.dateStart=this.getWeekStartDate(),this.filter.dateEnd=this.getWeekEndDate(),this.getOrdersList()},setFilterDateMonth:function(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),1,e.getUTCHours()),i=new Date(e.getUTCFullYear(),e.getUTCMonth()+1,0,23,59,59),r=t.toISOString().split("T")[0],a=i.toISOString().split("T")[0];this.filter.dateStart=r,this.filter.dateEnd=a,this.getOrdersList()},toggleAll:function(){this.selectedOrders.length?this.selectedOrders=[]:this.selectedOrders=this.ordersList.slice()},changeSort:function(e){this.pagination.sortBy===e?this.pagination.descending=!this.pagination.descending:(this.pagination.sortBy=e,this.pagination.descending=!1)}},mounted:function(){var e=new Date,t=e.toISOString().split("T")[0];this.dateNowStr=t;var i=t;e.setDate(e.getDate()+7);var r=e.toISOString().split("T")[0];this.filter.dateStart=i,this.filter.dateEnd=r,this.getOrdersList(),this.getStatusList(),this.getClientsList(),this.getClientTypeList(),void 0!==this.$route.query.client&&(this.filter.client=+this.$route.query.client)}},G=J,V=(i("2962"),Object(m["a"])(G,r,a,!1,null,null,null));t["default"]=V.exports},8509:function(e,t,i){},e151:function(e,t,i){!function(e,i){i(t)}(0,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),a=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)};function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(e,i){var r=[];return function e(i,a){if(i===a)return!0;if(i instanceof Date&&a instanceof Date)return+i==+a;if("object"!==(void 0===i?"undefined":t(i))||"object"!==(void 0===a?"undefined":t(a)))return!1;if(function(e,t){for(var i=r.length;i--;)if(!(r[i][0]!==e&&r[i][0]!==t||r[i][1]!==t&&r[i][1]!==e))return!0;return!1}(i,a))return!0;r.push([i,a]);var s=Object.keys(i),n=s.length;if(Object.keys(a).length!==n)return!1;for(;n--;)if(!e(i[s[n]],a[s[n]]))return!1;return!0}(e,i)}var o=new(function(){function e(){i(this,e),this.events={},this.ymapReady=!1,this.scriptIsNotAttached=!0}return r(e,[{key:"$on",value:function(e,t){var i=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),function(){i.events[e]=i.events[e].filter(function(e){return t!==e})}}},{key:"$emit",value:function(e,t){var i=this.events[e];i&&i.forEach(function(e){return e(t)})}}]),e}()),d=["fullscreenControl","geolocationControl","routeEditor","rulerControl","searchControl","trafficControl","typeSelector","zoomControl"];function l(e){return 0===e.filter(function(e){return![].concat(d,["default"]).includes(e)}).length}function c(e,t){var i=s(e);if(!t)return i;switch(i){case"Placemark":return"Point";case"Polyline":return"LineString";default:return i}}function u(e,i){var r=i?{type:"Feature",id:e.properties.markerId,geometry:{type:e.markerType,coordinates:e.coords},properties:e.properties,options:e.options}:new ymaps[e.markerType](e.coords,e.properties,e.options);return r.clusterName=e.clusterName,i||function(e,i){if(e&&"object"===(void 0===e?"undefined":t(e)))for(var r in e)i.events.add(r,e[r])}(e.callbacks,r),r}var m={data:function(){return{ymapEventBus:o,ymapId:"yandexMap"+Math.round(1e5*Math.random()),myMap:{},style:this.ymapClass?"":"width: 100%; height: 100%;"}},props:{coords:{type:Array,validator:function(e){return!e.filter(function(e){return isNaN(e)}).length},required:!0},zoom:{validator:function(e){return!isNaN(e)},default:18},clusterOptions:{type:Object,default:function(){return{}}},clusterCallbacks:{type:Object,default:function(){return{}}},behaviors:{type:Array,default:function(){return["default"]}},controls:{type:Array,default:function(){return["default"]},validator:function(e){return l(e)}},detailedControls:{type:Object,validator:function(e){return l(Object.keys(e))}},scrollZoom:{type:Boolean,default:!0},zoomControl:Object,mapType:{type:String,default:"map",validator:function(e){return["map","satellite","hybrid"].includes(e)}},placemarks:{type:Array,default:function(){return[]}},useObjectManager:{type:Boolean,default:!1},objectManagerClusterize:{type:Boolean,default:!0},ymapClass:String,initWithoutMarkers:{type:Boolean,default:!0},mapLink:String},computed:{coordinates:function(){return this.coords.map(function(e){return+e})}},methods:{init:function(){var e=this;if(window.ymaps&&ymaps.GeoObjectCollection&&(this.initWithoutMarkers||this.$slots.default||this.placemarks.length)){this.$emit("map-initialization-started");for(var t=[],i=this.$slots.default&&this.$slots.default.map(function(e){var t=e.componentOptions&&e.componentOptions.propsData;if(t){var i={};t.balloonTemplate&&(i={balloonContentLayout:ymaps.templateLayoutFactory.createClass(t.balloonTemplate)});var r={markerId:t.markerId,markerType:t.markerType,coords:function e(t){return t.map(function(t){return Array.isArray(t)?e(t):+t})}(t.coords),hintContent:t.hintContent,markerFill:t.markerFill,circleRadius:+t.circleRadius,clusterName:t.clusterName,markerStroke:t.markerStroke,balloon:t.balloon,callbacks:t.callbacks,properties:t.properties,options:t.options,balloonOptions:i};return t.icon&&"default#image"===t.icon.layout?(r.iconLayout=t.icon.layout,r.iconImageHref=t.icon.imageHref,r.iconImageSize=t.icon.imageSize,r.iconImageOffset=t.icon.imageOffset):r.icon=t.icon,r}}).filter(function(e){return e&&e.markerType})||[],r=0;r<i.length;r++){var n=i[r],o=c(n.markerType,this.useObjectManager),d={hintContent:n.hintContent,iconContent:n.icon&&n.icon.content,markerId:n.markerId},l=n.balloon?{balloonContentHeader:n.balloon.header,balloonContentBody:n.balloon.body,balloonContentFooter:n.balloon.footer}:{},m=Object.assign(d,l,n.properties),f=n.iconLayout?{iconLayout:n.iconLayout,iconImageHref:n.iconImageHref,iconImageSize:n.iconImageSize,iconImageOffset:n.iconImageOffset}:{preset:n.icon&&"islands#"+(b=n,(b.icon.color||"blue")+(b.icon.glyph?s(b.icon.glyph):b.icon.content?"Stretchy":""))+"Icon"},p=n.markerStroke?{strokeColor:n.markerStroke.color||"0066ffff",strokeOpacity:parseFloat(n.markerStroke.opacity)>=0?parseFloat(n.markerStroke.opacity):1,strokeStyle:n.markerStroke.style,strokeWidth:parseFloat(n.markerStroke.width)>=0?parseFloat(n.markerStroke.width):1}:{},v=n.markerFill?{fill:n.markerFill.enabled||!0,fillColor:n.markerFill.color||"0066ff99",fillOpacity:parseFloat(n.markerFill.opacity)>=0?parseFloat(n.markerFill.opacity):1,fillImageHref:n.markerFill.imageHref||""}:{},y=Object.assign(f,p,v,n.balloonOptions,n.options);"Circle"===o&&(n.coords=[n.coords,n.circleRadius]);var h=u({properties:m,options:y,markerType:o,coords:n.coords,clusterName:n.clusterName,callbacks:n.callbacks},this.useObjectManager);t.push(h)}var b;if(this.placemarks){var g=this.useObjectManager?"Point":"Placemark";this.placemarks.forEach(function(i){var r=i.properties,a=i.options,s=void 0===a?{}:a,n=i.coords,o=i.clusterName,d=i.callbacks,l=i.balloonTemplate;if(l){var c=ymaps.templateLayoutFactory.createClass(l);s.balloonContentLayout=c}var m=u({properties:r,options:s,markerType:g,coords:n,clusterName:o,callbacks:d},e.useObjectManager);t.push(m)})}this.myMap=new ymaps.Map(this.ymapId,{center:this.coordinates,zoom:+this.zoom,behaviors:this.behaviors,controls:this.controls,type:"yandex#"+this.mapType}),this.zoomControl&&(this.myMap.controls.remove("zoomControl"),this.myMap.controls.add(new ymaps.control.ZoomControl(this.zoomControl))),this.detailedControls&&Object.keys(this.detailedControls).forEach(function(t){e.myMap.controls.remove(t),e.myMap.controls.add(t,e.detailedControls[t])}),!1===this.scrollZoom&&this.myMap.behaviors.disable("scrollZoom");var I={options:this.clusterOptions,callbacks:this.clusterCallbacks,map:this.myMap,useObjectManager:this.useObjectManager,objectManagerClusterize:this.objectManagerClusterize};!function(e,t){var i=t.options,r=t.callbacks,s=t.map,n=t.useObjectManager,o=t.objectManagerClusterize,d={},l=[],c=!0,u=!1,m=void 0;try{for(var f,p=e[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var v=f.value;v.clusterName?d[v.clusterName]=d[v.clusterName]?[].concat(a(d[v.clusterName]),[v]):[v]:l.push(v)}}catch(e){u=!0,m=e}finally{try{!c&&p.return&&p.return()}finally{if(u)throw m}}for(var y in d){var h=i[y]||{},b=r[y]||{},g=h.layout||"\n      <div>{{ properties.balloonContentHeader }}</div>\n      <div>{{ properties.balloonContentBody }}</div>\n      <div>{{ properties.balloonContentFooter }}</div>\n    ";if(h.clusterBalloonItemContentLayout=ymaps.templateLayoutFactory.createClass(g),n){var I=new ymaps.ObjectManager(Object.assign({clusterize:o},h));for(var x in b)I.clusters.events.add(x,b[x]);I.add(d[y]),s.geoObjects.add(I)}else{var k=new ymaps.Clusterer(h);for(var _ in b)k.events.add(_,b[_]);k.add(d[y]),s.geoObjects.add(k)}}if(l.length){var S=n?new ymaps.ObjectManager({clusterize:!1}):new ymaps.GeoObjectCollection;l.forEach(function(e){return S.add(e)}),s.geoObjects.add(S)}}(t,I),this.$emit("map-was-initialized",this.myMap)}}},watch:{coordinates:function(e){this.myMap.panTo&&this.myMap.panTo(e)},placemarks:function(){window.ymaps&&(this.myMap.destroy&&this.myMap.destroy(),this.init())},zoom:function(){this.myMap.setZoom(this.zoom)}},render:function(e){return e("section",{class:"ymap-container"},[e("div",{attrs:{id:this.ymapId,class:this.ymapClass,style:this.style}}),e("div",{attrs:{class:"ymap-markers"}},[this.$slots.default])])},mounted:function(){var e=this;if(this.observer=new MutationObserver(function(e){this.myMap.destroy&&this.myMap.destroy(),this.init()}.bind(this)),this.observer.observe(document.querySelector(".ymap-markers"),{attributes:!0,childList:!0,characterData:!0,subtree:!0}),this.ymapEventBus.scriptIsNotAttached){var t=document.createElement("SCRIPT"),i=this.mapLink||"https://api-maps.yandex.ru/2.1/?lang=ru_RU";t.setAttribute("src",i),t.setAttribute("async",""),t.setAttribute("defer",""),document.body.appendChild(t),this.ymapEventBus.scriptIsNotAttached=!1,t.onload=function(){e.ymapEventBus.ymapReady=!0,e.ymapEventBus.$emit("scriptIsLoaded")}}this.ymapEventBus.ymapReady?ymaps.ready(this.init):this.ymapEventBus.$on("scriptIsLoaded",function(){e.ymapEventBus.initMap=function(){e.myMap.destroy(),e.init()},ymaps.ready(e.init)})},beforeDestroy:function(){this.myMap.geoObjects&&this.myMap.geoObjects.removeAll(),this.observer.disconnect()}},f={data:function(){return{ymapEventBus:o,unwatchArr:[]}},props:{coords:{type:Array,required:!0},hintContent:String,icon:Object,balloon:Object,markerType:{type:String,required:!0},markerFill:Object,markerStroke:Object,clusterName:String,circleRadius:{validator:function(e){return!isNaN(e)},default:1e3},callbacks:Object,balloonTemplate:String,markerId:{type:[String,Number],required:!0},properties:Object,options:Object},render:function(){},mounted:function(){var e=this;for(var t in this.$props)this.unwatchArr.push(this.$watch(t,function(t,i){return r=t,a=i,s=e.ymapEventBus,void(n(r,a)||(s.rerender&&clearTimeout(s.rerender),s.rerender=setTimeout(function(){return s.initMap&&s.initMap()},10)));var r,a,s}))},beforeDestroy:function(){this.unwatchArr.forEach(function(e){return e()})}};m.install=function(e){e.component("yandex-map",m),e.component("ymap-marker",f)},"undefined"!=typeof window&&window.Vue&&window.Vue.use(m);var p=m,v=f;e.yandexMap=p,e.ymapMarker=v,e.default=m,Object.defineProperty(e,"__esModule",{value:!0})})},fa73:function(e,t,i){}}]);
//# sourceMappingURL=chunk-5776d5c8.18648a28.js.map